(t=>{class e{constructor(t=e.default()){for(t=Object.assign(e.default(),t),this.width=t.width,this.height=t.height,this.crests=e.generateCrests(t),this.threshold=t.threshold,this.hierachy=t.hierachy,this.interpolate=t.interpolate,this.colors=t.colors,this.alpha=t.alpha;t.seed.length<4;)t.seed.push(Math.floor(10*Math.random()*(2456665234*Math.random())));this.seed=t.seed.sort(),this.Texture={parent:this,async generate(t){let e=new Uint8Array(this.parent.width*this.parent.height);for(let t=0;t<=this.parent.width;t++)for(let a=0;a<=this.parent.height;a++)e[a*this.parent.width+t]=await this.parent.pixel(t,a);return void 0!==t&&t(e),this.data=e,e},data:null,async ImageData(t=this.parent.colors,e=this.parent.alpha,a=!1){let r;this.data&&!a||await this.generate(),r="undefined"==typeof document?{[Symbol.toStringTag]:"ImageData",width:this.parent.width,height:this.parent.height,data:new Uint8Array(this.parent.width*this.parent.height*4)}:new ImageData(this.parent.width,this.parent.height);for(let e=0;e<r.data.length;e++){let a=this.data[Math.floor(e/4)]/255;if((e+1)%4!=0)if(t)switch((e+1)%4){case 1:let h=t[0][0],s=t[1][0];r.data[e]=h+(s-h)*a;break;case 2:let i=t[0][1],n=t[1][1];r.data[e]=i+(n-i)*a;break;case 3:let o=t[0][2],d=t[1][2];r.data[e]=o+(d-o)*a}else r.data[e]=this.data[Math.floor(e/4)];else this.parent.alpha?r.data[e]=255-255*a:r.data[e]=255}return r}}}async nearestCrest(t=0,a=0,r=0){return 0===this.crests.length?[1/0,1/0]:this.crests.slice(0).map(r=>({crest:r,distance:e.magnitude([t-r[0],a-r[1]])})).sort((t,e)=>t.distance-e.distance)[r].crest}async pixel(t,a,r=this.hierachy,h=this.interpolate){let s=await this.nearestCrest(t,a,r),i=e.magnitude([t-s[0],a-s[1]]);return h?e.interpolate(0,255,e.clamp(i/this.threshold,0,1)):255*e.clamp(i/this.threshold,0,1)}static clamp(t,e,a,r=!1){return t<e&&(t=r?a:e),t>a&&(t=r?e:a),t}static interpolate(t,e,a=.5){return t+(e-t)*(a=(Math.sin(Math.PI*a-Math.PI/2)+1)/2)}static generateCrests(t=e.default()){let a=e.rand(t.seed[0],t.seed[1],t.seed[2],t.seed[3]);for(let e=0;e<=t.prerun;e++)a();return Array.from({length:t.crests},()=>[Math.round(a()*t.width),Math.round(a()*t.height)])}static magnitude([t,e]){return Math.sqrt(t**2+e**2)}static default(){return{threshold:55,hierachy:0,width:100,height:100,colors:!1,alpha:!1,crests:20,interpolate:!0,seed:[10*Math.floor(Math.random()*(2456665234*Math.random())),10*Math.floor(Math.random()*(6242145234*Math.random())),10*Math.floor(Math.random()*(9253524321*Math.random())),10*Math.floor(Math.random()*(4364645634*Math.random()))],prerun:10}}static rand(t,e,a,r){return function(){var h=((t|=0)+(e|=0)|0)+(r|=0)|0;return r=r+1|0,t=e^e>>>9,e=(a|=0)+(a<<3)|0,a=(a=a<<21|a>>>11)+h|0,(h>>>0)/4294967296}}}"function"==typeof define&&define.amd?define(["Worley"],e):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=e:t.Worley=e})(globalThis);
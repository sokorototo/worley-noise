(t=>{class e{constructor(t=e.default()){for(t=Object.assign(e.default(),t),this.width=t.width,this.height=t.height,this.crests=e.generateCrests(t),this.threshold=t.threshold,this.hierachy=t.hierachy,this.interpolate=t.interpolate,this.interpolant=t.interpolant,this.colors=t.colors,this.alpha=!!t.alpha&&t.alpha+1e-5;t.seed.length<4;)t.seed.push(Math.floor(10*Math.random()*(2456665234*Math.random())));this.seed=t.seed.sort(),this.Texture={parent:this,async generate(){let t=new Uint8ClampedArray(this.parent.width*this.parent.height);for(let e=0;e<=this.parent.width;e++)for(let a=0;a<=this.parent.height;a++)t[a*this.parent.width+e]=await this.parent.pixel(e,a);return this.data=t,t},data:null,async ImageData(t=this.parent.colors,e=this.parent.alpha,a=!1){let r;this.data&&!a||await this.generate(),r="undefined"==typeof document?{[Symbol.toStringTag]:"ImageData",width:this.parent.width,height:this.parent.height,data:new Uint8ClampedArray(this.parent.width*this.parent.height*4)}:new ImageData(this.parent.width,this.parent.height);for(let a=0;a<r.data.length;a++){let h=this.data[Math.floor(a/4)]/255;if((a+1)%4!=0)if(t)switch((a+1)%4){case 1:let e=t[0][0],s=t[1][0];r.data[a]=e+(s-e)*h;break;case 2:let i=t[0][1],n=t[1][1];r.data[a]=i+(n-i)*h;break;case 3:let o=t[0][2],l=t[1][2];r.data[a]=o+(l-o)*h}else r.data[a]=this.data[Math.floor(a/4)];else r.data[a]=255-255*h*Number(e)}return r}}}async nearestCrest(t=0,a=0,r=0){if(0===this.crests.length)return[1/0,1/0];let h=this.crests.slice(0);for(let r=0;r<h.length;r++){let s=h[r];h[r]={crest:s,distance:e.magnitude([t-s[0],a-s[1]])}}return h.sort((t,e)=>t.distance-e.distance)[r].crest}async pixel(t,a,r=this.interpolate,h=this.hierachy){let s=await this.nearestCrest(t,a,h),i=e.magnitude([t-s[0],a-s[1]]);return r?this.interpolant(0,255,e.clamp(i/this.threshold,0,1)):255*e.clamp(i/this.threshold,0,1)}static clamp(t,e,a){return t>a?a:e>t?e:t}static interpolate(t,e,a=.5){return t+(e-t)*(a=(Math.sin(Math.PI*a-Math.PI/2)+1)/2)}static generateCrests(t=e.default()){let a=e.rand(t.seed[0],t.seed[1],t.seed[2],t.seed[3]);for(let e=0;e<=t.prerun;e++)a();return Array.from({length:t.crests},()=>[Math.round(a()*t.width),Math.round(a()*t.height)])}static magnitude(t){return Math.sqrt(t[0]**2+t[1]**2)}static default(){return{width:100,height:100,crests:20,threshold:55,hierachy:0,interpolate:!0,interpolant:e.interpolate,colors:!1,alpha:!1,seed:[10*Math.floor(Math.random()*(2456665234*Math.random())),10*Math.floor(Math.random()*(6242145234*Math.random())),10*Math.floor(Math.random()*(9253524321*Math.random())),10*Math.floor(Math.random()*(4364645634*Math.random()))],prerun:2}}static rand(t,e,a,r){return function(){var h=((t|=0)+(e|=0)|0)+(r|=0)|0;return r=r+1|0,t=e^e>>>9,e=(a|=0)+(a<<3)|0,a=(a=a<<21|a>>>11)+h|0,(h>>>0)/4294967296}}}"function"==typeof define&&define.amd?define(["Worley"],e):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=e:t.Worley=e})(globalThis);